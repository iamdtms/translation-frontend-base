(function(e){"use strict";function a(){var a=e("html").attr("lang");return a||(a=navigator.language||navigator.userLanguage||""),a}var n,t=Array.prototype.slice;n=function(a){this.options=e.extend({},n.defaults,a),this.parser=this.options.parser,this.locale=this.options.locale,this.messageStore=this.options.messageStore,this.languages={}},n.prototype={localize:function(a){var n,t,o,i,l,s;for(o=this.locale,i=0;o;){n=o.split("-"),t=n.length;do{if(l=n.slice(0,t).join("-"),s=this.messageStore.get(l,a),s)return s;t--}while(t);if(o===this.options.fallbackLocale)break;o=e.i18n.fallbacks[this.locale]&&e.i18n.fallbacks[this.locale][i]||this.options.fallbackLocale,e.i18n.log("Trying fallback locale for "+this.locale+": "+o+" ("+a+")"),i++}return""},destroy:function(){e.removeData(document,"i18n")},load:function(a,n){var t,o,i,l={};if(a||n||(a="i18n/"+e.i18n().locale+".json",n=e.i18n().locale),"string"==typeof a&&"json"!==a.split("?")[0].split(".").pop()){for(l[n]=a+"/"+n+".json",t=(e.i18n.fallbacks[n]||[]).concat(this.options.fallbackLocale),o=0;o<t.length;o++)i=t[o],l[i]=a+"/"+i+".json";return this.load(l)}return this.messageStore.load(a,n)},parse:function(a,n){var t=this.localize(a);return this.parser.language=e.i18n.languages[e.i18n().locale]||e.i18n.languages.default,""===t&&(t=a),this.parser.parse(t,n)}},e.i18n=function(a,o){var i,l=e.data(document,"i18n"),s="object"==typeof a&&a;return s&&s.locale&&l&&l.locale!==s.locale&&(l.locale=s.locale),l||(l=new n(s),e.data(document,"i18n",l)),"string"==typeof a?(i=void 0!==o?t.call(arguments,1):[],l.parse(a,i)):l},e.fn.i18n=function(){var a=e.data(document,"i18n");return a||(a=new n,e.data(document,"i18n",a)),this.each(function(){var n,t,o,i,l=e(this),s=l.data("i18n");s?(n=s.indexOf("["),t=s.indexOf("]"),-1!==n&&-1!==t&&n<t?(o=s.slice(n+1,t),i=s.slice(t+1),"html"===o?l.html(a.parse(i)):l.attr(o,a.parse(i))):l.text(a.parse(s))):l.find("[data-i18n]").i18n()})},e.i18n.languages={},e.i18n.messageStore=e.i18n.messageStore||{},e.i18n.parser={parse:function(e,a){return e.replace(/\$(\d+)/g,function(e,n){var t=parseInt(n,10)-1;return void 0!==a[t]?a[t]:"$"+n})},emitter:{}},e.i18n.fallbacks={},e.i18n.debug=!1,e.i18n.log=function(){window.console&&e.i18n.debug&&window.console.log.apply(window.console,arguments)},n.defaults={locale:a(),fallbackLocale:"en",parser:e.i18n.parser,messageStore:e.i18n.messageStore},e.i18n.constructor=n})(jQuery);